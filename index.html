<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.2" />






<meta name="description" content="zhuyanlin的个人博客">
<meta property="og:type" content="website">
<meta property="og:title" content="YanLin">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="YanLin">
<meta property="og:description" content="zhuyanlin的个人博客">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="YanLin">
<meta name="twitter:description" content="zhuyanlin的个人博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '154664cad9247e0a815b49e17e029b04',
      indexName: 'zhuyanlin',
      hits: {"per_page":10},
      labels: {"input_placeholder":"输入关键字","hits_empty":"没有找到与 [${query}] 相关的内容","hits_stats":"${hits} 条相关记录，共 ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>YanLin</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">YanLin</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  
  <div class="algolia-popup popup search-popup">
    <div class="algolia-search">
      <div class="algolia-search-input-icon">
        <i class="fa fa-search"></i>
      </div>
      <div class="algolia-search-input" id="algolia-search-input"></div>
    </div>

    <div class="algolia-results">
      <div id="algolia-stats"></div>
      <div id="algolia-hits"></div>
      <div id="algolia-pagination" class="algolia-pagination"></div>
    </div>

    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
  </div>




    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/19/Android应用开发之读取本地服务器图片并缓存/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zhuyanlin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YanLin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/19/Android应用开发之读取本地服务器图片并缓存/" itemprop="url">Android应用开发之读取本地服务器图片并缓存</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-19T21:14:48+08:00">
                2017-10-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android应用开发/" itemprop="url" rel="index">
                    <span itemprop="name">Android应用开发</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="MainActivity-java"><a href="#MainActivity-java" class="headerlink" title="MainActivity.java"></a>MainActivity.java</h1><pre><code>package com.m520it.temp233;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileOutputStream;
import java.io.InputStream;
import java.io.InputStreamReader;
import java.net.HttpURLConnection;
import java.net.URL;
import java.util.ArrayList;

import com.m520it.temp.R;

import android.app.Activity;
import android.graphics.Bitmap;
import android.graphics.Bitmap.CompressFormat;
import android.graphics.BitmapFactory;
import android.os.Bundle;
import android.util.Log;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;
import android.widget.ImageView;

public class MainActivity extends Activity {

    //注意ArrayList&lt;String&gt;是一个类，相比较String[]，这个类有更多的方法，使用起来更加方便
    private ArrayList&lt;String&gt; mUrlStringList = new ArrayList&lt;String&gt;();
    private int mImageIndex = 0;
    private ImageView mImgIv;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        /**
         * 开发步骤：
         * 1.从网络上读取photo.txt，并封装成ArrayList&lt;String&gt;
         * 2.创建一个索引变量，用来控制当前的显示图片索引
         * 3.根据索引从ArrayList&lt;String&gt;取出一个字符串（图片的网址），并根据网址获取图片显示到控件上来
         */
        mImgIv = (ImageView) findViewById(R.id.img_iv);
        Button presBtn = (Button) findViewById(R.id.pres_btn);
        Button nextBtn = (Button) findViewById(R.id.next_btn);


        //网络请求一定要放在子线程里面，主要是万一访问失败，不会影响到主线程
        new Thread() {
            public void run() {
                //加载网络或得的图片，而且设计到网络的话就要打开允许网络的权限
                loadUrlImages();

//                for (int i = 0; i &lt; mUrlStringList.size(); i++) {
//                    Log.v(&quot;520it&quot;, mUrlStringList.get(i));
//                }
                loadImages(mImageIndex);
            }
        }.start();

        //上一张按钮的点击事件
        presBtn.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {
                mImageIndex--;
                if (mImageIndex == -1) {
                    mImageIndex = mUrlStringList.size()-1;
                }

                //网络请求一定要放在子线程里面，主要是万一访问失败，不会影响到主线程
                new Thread() {
                    public void run() {
                        loadImages(mImageIndex);
                    }
                }.start();
            }

        });

        //下一张按钮的点击事件
        nextBtn.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {
                mImageIndex++;
                if (mImageIndex == mUrlStringList.size()) {
                    mImageIndex = 0;
                }

                //网络请求一定要放在子线程里面，主要是万一访问失败，不会影响到主线程
                new Thread() {
                    public void run() {
                        loadImages(mImageIndex);
                    }
                }.start();
            }

        });
    }

    private void loadImages(int index) {
        try {
            String string = mUrlStringList.get(index);

            //获得网络连接的图片名称
            //String imgName = getImageName(string);

            //获得文件的路径
            File f = new File(getFilesDir(),getImageName(string));

            //如果文件存在并且文件里面有内容，则读取，就不需要网络获取图片了
            if (f.exists()&amp;&amp;f.length()&gt;0) {
                //使用BitmapFactory这个工具类将文件转换成位图
                final Bitmap decodeFile = BitmapFactory.decodeFile(f.getAbsolutePath());
                //当然，显示图片需要再主线程中
                runOnUiThread(new Runnable() {

                    @Override
                    public void run() {
                        mImgIv.setImageBitmap(decodeFile);
                    }
                });
                return;
            }

            Log.v(&quot;520it&quot;, string);
            URL url = new URL(string);
            //一定要使用HttpURLConnection类，这个比较方便，因为这个网络请求就是Http的协议
            HttpURLConnection ocnn = (HttpURLConnection) url.openConnection();
            int responseCode = ocnn.getResponseCode(); 
            if (responseCode == 200) {
                InputStream inputStream = ocnn.getInputStream();

                final Bitmap bm = BitmapFactory.decodeStream(inputStream);

                //使用这个FileOutputStream比较方便，直接是继承自OutputStream
                FileOutputStream openFileOutput = openFileOutput(getImageName(string), MODE_PRIVATE);

                //注意压缩格式在CompressFormat这个枚举中
                bm.compress(CompressFormat.PNG, 100, openFileOutput);

                //只有在主线程中才能显示图片，original thread = main thread = UI thread
                //使用Activity.runOnUiThread()方法可以让代码转移到主线程中
                runOnUiThread(new Runnable() {

                    @Override
                    public void run() {
                        mImgIv.setImageBitmap(bm);
                    }

                });
            }
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

    private String getImageName(String imageUrl) {
        //获取类似http://192.168.176.1:8080/images/a.png的最后一个“/”
        int index = imageUrl.lastIndexOf(&quot;/&quot;);
        //拆分字符串
        String returnVal = imageUrl.substring(index+1);
        return returnVal;
    }

    private void loadUrlImages() {
        try {
            //设置URL
            URL url = new URL(&quot;http://192.168.176.1:8080/images/photo.txt&quot;);

            //使用http协议打开连接
            HttpURLConnection conn = (HttpURLConnection) url.openConnection();

            //**这里一定要注意，本机上的ip是127.0.0.1，但是在安卓虚拟机上访问主机的ip一定要通过arp -a指令在命令行中进行查找安卓虚拟机中
            //主机显示的ip地址，否则在安卓上面访问127.0.0.1，实际上是安卓虚拟机的本地ip，一定要注意
            int responseCode = conn.getResponseCode(); 

            if (responseCode == 200) {
                //读取文件，现在是字节流
                InputStream is = conn.getInputStream();

                //字符流
                InputStreamReader isr = new InputStreamReader(is);

                //缓冲流，因为不需要讲数据存到文件中，所以直接搞个缓冲区即可
                BufferedReader reader = new BufferedReader(isr);

                String line = null;

                while ((line = reader.readLine()) != null) {
                    mUrlStringList.add(line);
                }
            }

        } catch (Exception e) {
            e.printStackTrace();
        }
    }

}
</code></pre><h1 id="activity-main-xml"><a href="#activity-main-xml" class="headerlink" title="activity_main.xml"></a>activity_main.xml</h1><pre><code>&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    android:orientation=&quot;vertical&quot; &gt;

    &lt;ImageView 
        android:id=&quot;@+id/img_iv&quot;
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;0dp&quot;
        android:layout_weight=&quot;1&quot;/&gt;

    &lt;LinearLayout 
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:orientation=&quot;horizontal&quot;&gt;

        &lt;Button 
            android:id=&quot;@+id/pres_btn&quot;
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_weight=&quot;1&quot;
            android:text=&quot;上一张&quot;/&gt;

        &lt;Button 
            android:id=&quot;@+id/next_btn&quot;
            android:layout_width=&quot;0dp&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_weight=&quot;1&quot;
            android:text=&quot;下一张&quot;/&gt;

    &lt;/LinearLayout&gt;

&lt;/LinearLayout&gt;
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/15/Android应用开发之数据库增删改查的Google实现/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zhuyanlin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YanLin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/15/Android应用开发之数据库增删改查的Google实现/" itemprop="url">Android应用开发之数据库增删改查的Google实现</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-15T20:10:44+08:00">
                2017-10-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android应用开发/" itemprop="url" rel="index">
                    <span itemprop="name">Android应用开发</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="MainActivity-java"><a href="#MainActivity-java" class="headerlink" title="MainActivity.java"></a>MainActivity.java</h1><pre><code>package com.m520it.sqlite3;

import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;

import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.widget.Toast;

public class MainActivity extends Activity {

    private ContactDao mDao;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        mDao=new ContactDao(this);
    }

    public void insertContact(View v) {
        boolean ifInserted = mDao.insertContact(&quot;lisi&quot;, &quot;150122222&quot;);
        Toast.makeText(this, ifInserted?&quot;插入成功&quot;:&quot;插入失败&quot;, 0).show();
    }

    public void updateContact(View v) {
        boolean updateContact = mDao.updateContact(&quot;zhangsan&quot;, &quot;10086&quot;);
        Toast.makeText(this, updateContact?&quot;更新成功&quot;:&quot;更新失败&quot;, 0).show();
    }

    public void deleteContact(View v) {
        boolean deleteContact = mDao.deleteContact(&quot;zhangsan&quot;);
        Toast.makeText(this, deleteContact?&quot;删除成功&quot;:&quot;删除失败&quot;, 0).show();
    }

    public void queryContact(View v) {
        String result = mDao.queryContact(&quot;150122222&quot;);
        Toast.makeText(this, result, 0).show();
    }

}
</code></pre><h1 id="ContactDao-java"><a href="#ContactDao-java" class="headerlink" title="ContactDao.java"></a>ContactDao.java</h1><pre><code>package com.m520it.sqlite3;

import android.content.ContentValues;
import android.content.Context;
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;

/**
 *    实现增删查改
 */
public class ContactDao {

    private DbOpenHelper mHelper;

    public ContactDao(Context c) {
        mHelper=new DbOpenHelper(c);
    }

    /**
     * 插入一条联系人信息
     * @param username
     * @param phone
     */
    public boolean insertContact(String username,String phone){
        SQLiteDatabase db = mHelper.getWritableDatabase();
        // _id username phone
        //nullColumnHack 比如 放了username 那么插入的时候 username就不能为null
        //如果nullColumnHack设置为null  那么此次插入的字段可以允许某些字段不插入
        //ContentValues 键值对 源代码里面只是简单的维护了一个HashMap
        ContentValues values=new ContentValues();
        //key 插入的数据库表的字段名  value就是要插入的值
        values.put(DbOpenHelper._USERNAME, username);
        values.put(DbOpenHelper._PHONE, phone);
        //@return 新插入的行的id 如果是-1则说明插入失败
        long rowId = db.insert(DbOpenHelper.TABLE_NAME, null , values);
        return rowId!=-1;
    }

    public boolean updateContact(String username,String newPhone){
        SQLiteDatabase db = mHelper.getWritableDatabase();
        ContentValues values=new ContentValues();
        values.put(DbOpenHelper._PHONE, newPhone);
        //whereClause  where语句
        //whereArgs where语句的绑定值
        //@return int 更新了几行就返回多少
        int updateRows = db.update(DbOpenHelper.TABLE_NAME,
                values, DbOpenHelper._USERNAME+&quot;=?&quot;, new String[]{username});
        return updateRows&gt;0;
    }

    public boolean deleteContact(String username){
        SQLiteDatabase db = mHelper.getWritableDatabase();
        //whereClause  where语句
        //whereArgs where语句的绑定值
        int deleteRows = db.delete(DbOpenHelper.TABLE_NAME, &quot;username=?&quot;, new String[]{username});
        return deleteRows&gt;0;
    }

    public String queryContact(String searchPhone){

        String result=&quot;&quot;;

        SQLiteDatabase db = mHelper.getReadableDatabase();
//        columns String[] 返回的行
        Cursor cursor = db.query(DbOpenHelper.TABLE_NAME, 
                new String[]{DbOpenHelper._USERNAME,DbOpenHelper._PHONE},
                &quot;phone=?&quot;, new String[]{searchPhone}, 
                null, null, null);
        while (cursor.moveToNext()) {
            //传入一个列的列名 返回一个列的索引
            int columnIndex = cursor.getColumnIndex(DbOpenHelper._USERNAME);
            //传入一个列的索引 返回该列下 某一行的值
            String username = cursor.getString(columnIndex);

            //传入一个列的列名 返回一个列的索引
            int phoneColumnIndex = cursor.getColumnIndex(DbOpenHelper._PHONE);
            //传入一个列的索引 返回该列下 某一行的值
            String phone = cursor.getString(phoneColumnIndex);

            result+=(username+&quot;  &quot;+phone+&quot; \n&quot;);
        }
        return result;
    }


}
</code></pre><h1 id="activity-main"><a href="#activity-main" class="headerlink" title="activity_main"></a>activity_main</h1><pre><code>&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot; 
    android:orientation=&quot;vertical&quot; &gt;

    &lt;Button
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:onClick=&quot;insertContact&quot;
        android:text=&quot;增加联系人&quot; /&gt;
    &lt;Button
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:onClick=&quot;updateContact&quot;
        android:text=&quot;修改联系人&quot; /&gt;
    &lt;Button
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:onClick=&quot;deleteContact&quot;
        android:text=&quot;删除联系人&quot; /&gt;
    &lt;Button
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:onClick=&quot;queryContact&quot;
        android:text=&quot;查询联系人&quot; /&gt;

&lt;/LinearLayout&gt;
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/15/Android应用开发之数据库的增删改查/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zhuyanlin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YanLin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/15/Android应用开发之数据库的增删改查/" itemprop="url">Android应用开发之数据库的增删改查</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-15T18:13:51+08:00">
                2017-10-15
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android应用开发/" itemprop="url" rel="index">
                    <span itemprop="name">Android应用开发</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="MainActivity-java"><a href="#MainActivity-java" class="headerlink" title="MainActivity.java"></a>MainActivity.java</h1><pre><code>package com.m520it.temp;

import android.app.Activity;
import android.os.Bundle;
import android.view.View;

public class MainActivity extends Activity {

    private ContactDao mContactDao;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        mContactDao = new ContactDao(this);
    }

    public void insertContact(View v) {
        mContactDao.insertContact(&quot;zhangsan&quot;, &quot;11111111111&quot;);
    }

    public void deleteContact(View v) {
        mContactDao.deleteContact(&quot;zhangsan&quot;);
    }

    public void updateContact(View v) {
        mContactDao.updateContact(&quot;zhangsan&quot;, &quot;22222222222&quot;);
    }

    public void queryContact(View v) {
        mContactDao.queryContact(&quot;zhangsan&quot;);
    }
}
</code></pre><h1 id="ContactDao-java"><a href="#ContactDao-java" class="headerlink" title="ContactDao.java"></a>ContactDao.java</h1><pre><code>package com.m520it.temp;

import android.content.Context;
import android.database.Cursor;
import android.database.sqlite.SQLiteDatabase;
import android.util.Log;


public class ContactDao {

    private DbOpenHelper mHelper;

    //*Context是一个场景，MainActivity就是一个场景，并且它本身就是继承自Context
    public ContactDao(Context c) {
        //1、首先是要创建一个数据库文件的帮助类，类似于File f = File(...)
        mHelper = new DbOpenHelper(c);
    }

    public void insertContact(String username,String phone) {
        SQLiteDatabase db = mHelper.getWritableDatabase();
        //2、第二个参数是缺省值，补第一个字符串参数中&quot;?&quot;的位置，同时第二个参数直接内存分配数组，这样就不用另外定义String[]然后再传递了
        //问号代表的缺省值已经是一个字符串了，所以要把单引号去掉，不然程序崩溃
        db.execSQL(&quot;insert into contact (username,phone) values (?,?);&quot;, 
                new String[]{username,phone});
    }

    public void deleteContact(String username) {
        SQLiteDatabase db = mHelper.getWritableDatabase();
        db.execSQL(&quot;delete from contact where username=?;&quot;,
                new String[]{username});
    }

    public void updateContact(String username,String phone) {
        SQLiteDatabase db = mHelper.getWritableDatabase();
        db.execSQL(&quot;update contact set phone=? where username=?&quot;,
                new String[]{phone,username});
    }

    public void queryContact(String username) {
        SQLiteDatabase db = mHelper.getReadableDatabase();
        //3、这个光标是指向查找结果的行
         Cursor cursor = db.rawQuery(&quot;select phone from contact where username=?&quot;, 
                new String[]{username});
         while(cursor.moveToNext()) {
             //4、getString中的columnIndex参数我还搞不清楚是干什么的，难道是代表我们要查找的第0列吗？？
             String string = cursor.getString(0);
             Log.v(&quot;520it&quot;, string);
         }
    }

}
</code></pre><h1 id="DbOpenHelper-java"><a href="#DbOpenHelper-java" class="headerlink" title="DbOpenHelper.java"></a>DbOpenHelper.java</h1><pre><code>package com.m520it.temp;

import android.content.Context;
import android.database.sqlite.SQLiteDatabase;
import android.database.sqlite.SQLiteOpenHelper;
import android.provider.BaseColumns;
import android.util.Log;

public class DbOpenHelper extends SQLiteOpenHelper implements BaseColumns{

    public static final String DB_NAME = &quot;contact.db&quot;;
    public static final int DB_VERSION = 5;
    public static final String _TABLENAME = &quot;contact&quot;;
    public static final String _USERNAME = &quot;username&quot;;
    public static final String _PHONE = &quot;phone&quot;;

    public DbOpenHelper(Context context) {
        super(context, DB_NAME, null, DB_VERSION);
    }

    //当创建数据库文件是会调用这个函数
    @Override
    public void onCreate(SQLiteDatabase db) {
        db.execSQL(&quot;create table &quot;+_TABLENAME+&quot;(&quot;+_ID+&quot; integer primary key autoincrement,&quot; +
                &quot;&quot;+_USERNAME+&quot; text,&quot;+_PHONE+&quot; text);&quot;);
    }

    //当跟新数据库信息是会调用这个函数
    @Override
    public void onUpgrade(SQLiteDatabase db, int oldVersion, int newVersion) {
        Log.v(&quot;520it&quot;, &quot;oldVersion=&quot;+oldVersion+&quot;   newVersion=&quot;+newVersion);
    }

}
</code></pre><h1 id="avtivity-main"><a href="#avtivity-main" class="headerlink" title="avtivity_main"></a>avtivity_main</h1><pre><code>&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    android:orientation=&quot;vertical&quot; &gt;

    &lt;Button
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:onClick=&quot;insertContact&quot;
        android:text=&quot;增加联系人&quot; /&gt;

    &lt;Button
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:onClick=&quot;deleteContact&quot;
        android:text=&quot;删除联系人&quot; /&gt;

    &lt;Button
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:onClick=&quot;updateContact&quot;
        android:text=&quot;更改联系人&quot; /&gt;

    &lt;Button
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:onClick=&quot;queryContact&quot;
        android:text=&quot;查找联系人&quot; /&gt;

&lt;/LinearLayout&gt;
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/13/Android应用开发之解析xml实例/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zhuyanlin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YanLin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/13/Android应用开发之解析xml实例/" itemprop="url">Android应用开发之解析xml实例</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-13T18:29:29+08:00">
                2017-10-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android应用开发/" itemprop="url" rel="index">
                    <span itemprop="name">Android应用开发</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="MainActivity-java"><a href="#MainActivity-java" class="headerlink" title="MainActivity.java"></a>MainActivity.java</h1><pre><code>package com.m520it.weatherparse;

import java.io.InputStream;

import org.xmlpull.v1.XmlPullParser;

import android.app.Activity;
import android.content.res.AssetManager;
import android.os.Bundle;
import android.util.Xml;
import android.view.View;
import android.widget.Button;
import android.widget.TextView;


public class MainActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

        //
        Button parseWeatherBtn = (Button) findViewById(R.id.parseweather_btn);
        final TextView dispalyTv = (TextView) findViewById(R.id.display_tv);

        parseWeatherBtn.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {
                String info = null;
                try {
                    info = usePull2ParseWeather();
                } catch (Exception e) {
                    // TODO Auto-generated catch block
                    e.printStackTrace();
                }
                dispalyTv.setText(info);
            }
        });
    }

    protected String usePull2ParseWeather() throws Exception {

        String string = &quot;&quot;;

        //1、获取asserts中的文件
        AssetManager assetManager = getAssets();

        //2、创建一个流，指向weather.xml
        InputStream is = assetManager.open(&quot;weather.xml&quot;);

        //3、创建一个pull解析器，并打开weather.xml
        XmlPullParser newPullParser = Xml.newPullParser();
        newPullParser.setInput(is, &quot;utf-8&quot;);

        //4、获取标签状态
        int eventType = newPullParser.getEventType();

        //5、循环来取值
        while(eventType != XmlPullParser.END_DOCUMENT) {
            if(eventType == XmlPullParser.START_TAG
                    &amp;&amp;newPullParser.getName().equals(&quot;string&quot;)) {
                //这里注意字符串的比较一定要用equals()方法
                string += newPullParser.nextText()+&quot;\n&quot;;
            }
            eventType = newPullParser.next();
        }

        return string;
    }

}
</code></pre><h1 id="activity-main-xml"><a href="#activity-main-xml" class="headerlink" title="activity_main.xml"></a>activity_main.xml</h1><pre><code>&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot; 
    android:orientation=&quot;vertical&quot;&gt;

    &lt;Button
        android:id=&quot;@+id/parseweather_btn&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:text=&quot;@string/parse_weather&quot; /&gt;

    &lt;TextView
        android:id=&quot;@+id/display_tv&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot; /&gt;

&lt;/LinearLayout&gt;
</code></pre><h1 id="assets-weather-xml"><a href="#assets-weather-xml" class="headerlink" title="assets/weather.xml"></a>assets/weather.xml</h1><h2 id="这个是被解析的文件，存放在assets文件夹下"><a href="#这个是被解析的文件，存放在assets文件夹下" class="headerlink" title="这个是被解析的文件，存放在assets文件夹下"></a>这个是被解析的文件，存放在assets文件夹下</h2><pre><code>&lt;ArrayOfString xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns=&quot;http://WebXml.com.cn/&quot;&gt;
    &lt;string&gt;北京&lt;/string&gt;
    &lt;string&gt;2015-9-7 15:22:46&lt;/string&gt;
    &lt;string&gt;17℃/29℃&lt;/string&gt;
    &lt;string&gt;无持续风向微风&lt;/string&gt;
    &lt;string&gt;今日天气实况：气温：28℃；风向/风力：西南风 2级；湿度：44%；空气质量：暂无；紫外线强度：强&lt;/string&gt;
&lt;/ArrayOfString&gt;
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/13/Android应用开发之存储和解析xml文件/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zhuyanlin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YanLin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/13/Android应用开发之存储和解析xml文件/" itemprop="url">Android应用开发之存储和解析xml文件</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-13T17:34:49+08:00">
                2017-10-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android应用开发/" itemprop="url" rel="index">
                    <span itemprop="name">Android应用开发</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="MainActivity-java"><a href="#MainActivity-java" class="headerlink" title="MainActivity.java"></a>MainActivity.java</h1><pre><code>package com.m520it.saveandparseXML;

import android.app.Activity;
import android.os.Bundle;
import android.view.View;
import android.widget.TextView;

import com.m520it.temp1.R;


public class MainActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

    }

    public void click2SaveXML(View v) {

        String passport = &quot;2827887497&quot;;
        String password = &quot;zhuyanlin&quot;;
        try {
            XMLUtil.saveXMLByStringBuilder(this,passport,password);
        } catch (Exception e) {
            e.printStackTrace();
        }

        try {
            XMLUtil.saveXMLByXMLSerializer(this,passport,password);
        } catch (Exception e) {
            e.printStackTrace();
        }

    }

    public void click2ParseXML(View v) {
        try {
            TextView displayTv = (TextView) findViewById(R.id.display_tv);
            String result = XMLUtil.parseXMLByPullParser(this);
            displayTv.setText(result);
        } catch (Exception e) {
            e.printStackTrace();
        }
    }

}
</code></pre><h1 id="XMLUtil-java"><a href="#XMLUtil-java" class="headerlink" title="XMLUtil.java"></a>XMLUtil.java</h1><pre><code>package com.m520it.saveandparseXML;

import java.io.BufferedWriter;
import java.io.File;
import java.io.FileInputStream;
import java.io.FileWriter;
import java.io.OutputStream;

import org.xmlpull.v1.XmlPullParser;
import org.xmlpull.v1.XmlSerializer;

import android.content.Context;
import android.util.Xml;

public class XMLUtil {

    /**
     * 以此方法保存的xml文件效果：
     * &lt;map&gt;
     * &lt;string name=&quot;usename&quot;&gt;zhangsan&lt;/string&gt;
     * &lt;string name=&quot;psk&quot;&gt;123456&lt;/string&gt;
     * &lt;/map&gt;
     * 一定有异常用throw，可能存在异常用throws
     */
    public static void saveXMLByStringBuilder(MainActivity mainActivity,
            String passport, String password) throws Exception {

        //1、建立一个字符串，相比于String，StringBuilder是可变的
        StringBuilder stringBuilder = new StringBuilder();
        stringBuilder.append(&quot;&lt;map&gt;&quot;);
        stringBuilder.append(&quot;&lt;string name=\&quot;usename\&quot;&gt;&quot;+passport+&quot;&lt;/string&gt;&quot;);
        stringBuilder.append(&quot;&lt;string name=\&quot;psk\&quot;&gt;&quot;+password+&quot;&lt;/string&gt;&quot;);
        stringBuilder.append(&quot;&lt;/map&gt;&quot;);
        String result = stringBuilder.toString();

        //2、创建文件的句柄，getFileDir()是在Content类下的，而MainActivity是继承自Content
        File f = new File(mainActivity.getFilesDir(),&quot;qqinfo.xml&quot;);

        //3、使用字符流，并且要进行可能存在异常的检查，我们可以将方法的异常抛出
        BufferedWriter bw = new BufferedWriter(new FileWriter(f));

        //4、写入刚刚建立的字符串
        bw.write(result);

        //5、初次之外，还需进行刷新，当然关闭文件也是可以的，里面已经进行了刷新
        //bw.flush();
        bw.close();
    }

    /**
     * 以此方法保存的xml文件效果：
     * &lt;map&gt;
     * &lt;username&gt;zhangsan&lt;/username&gt;
     * &lt;psk&gt;123456&lt;/psk&gt;
     * &lt;/map&gt;
     */
    public static void saveXMLByXMLSerializer(MainActivity mainActivity,
            String passport, String password) throws Exception {

         //1、定义一个xml序列化器
         XmlSerializer xmlSerializer = Xml.newSerializer();

         //2、需要一个输出流，使用Content中的openFileOutput()比较方便
         OutputStream os = mainActivity.openFileOutput(&quot;qqinfo1.xml&quot;, Context.MODE_PRIVATE);

         //3、设置输出路径和格式
         xmlSerializer.setOutput(os, &quot;utf-8&quot;);

         //4、设置xml文件的开始、各个开标签闭标签和标签里面的内容，但是把标签属性给去掉了
         xmlSerializer.startDocument(&quot;utf-8&quot;, true);

         xmlSerializer.startTag(null, &quot;map&quot;);

         xmlSerializer.startTag(null, &quot;username&quot;);
         xmlSerializer.text(passport);
         xmlSerializer.endTag(null, &quot;username&quot;);

         xmlSerializer.startTag(null, &quot;psk&quot;);
         xmlSerializer.text(password);
         xmlSerializer.endTag(null, &quot;psk&quot;);

         xmlSerializer.endTag(null, &quot;map&quot;);

         xmlSerializer.endDocument();

    }

    public static String parseXMLByPullParser(MainActivity mainActivity) throws Exception {

        String string = &quot;&quot;;

        //1、创建一个PULL解析器
        XmlPullParser xmlPullParser = Xml.newPullParser();

        //2、使用流告诉解析器文件的位置和编码
        FileInputStream fis = mainActivity.openFileInput(&quot;qqinfo1.xml&quot;);
        xmlPullParser.setInput(fis, &quot;utf-8&quot;);

        int eventType = xmlPullParser.getEventType();
//        这里要将整型转换成字符串型
//        Log.v(&quot;520it&quot;,eventType + &quot;&quot;);
//        
//        eventType = xmlPullParser.next();
//        Log.v(&quot;520it&quot;,eventType + &quot;&quot;);
//        Log.v(&quot;520it&quot;,xmlPullParser.getName());
//        
//        eventType = xmlPullParser.next();
//        Log.v(&quot;520it&quot;,eventType + &quot;&quot;);
//        Log.v(&quot;520it&quot;,xmlPullParser.getName());

        //3、查询状态，并取出内容，一直到文档的结束
        while(eventType != XmlPullParser.END_DOCUMENT) {
            if(eventType == XmlPullParser.START_TAG) {
                if(xmlPullParser.getName().equals(&quot;username&quot;)) {
                    string += &quot;username = &quot; + xmlPullParser.nextText() + &quot;\n&quot;;
                }else if (xmlPullParser.getName().equals(&quot;psk&quot;)){
                    string += &quot;psk = &quot; + xmlPullParser.nextText() + &quot;\n&quot;;
                }
            }
            eventType = xmlPullParser.next();
        }

        return string;
    }
}
</code></pre><h1 id="avtivity-main-xml"><a href="#avtivity-main-xml" class="headerlink" title="avtivity_main.xml"></a>avtivity_main.xml</h1><h2 id="按钮不是采用读取id的方法，而是直接使用的onClick属性，仅仅是为了方便，但是在正式的项目中一定要使用读取id设置监听事件的方法"><a href="#按钮不是采用读取id的方法，而是直接使用的onClick属性，仅仅是为了方便，但是在正式的项目中一定要使用读取id设置监听事件的方法" class="headerlink" title="按钮不是采用读取id的方法，而是直接使用的onClick属性，仅仅是为了方便，但是在正式的项目中一定要使用读取id设置监听事件的方法"></a>按钮不是采用读取id的方法，而是直接使用的onClick属性，仅仅是为了方便，但是在正式的项目中一定要使用读取id设置监听事件的方法</h2><pre><code>&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    android:orientation=&quot;vertical&quot; &gt;

    &lt;Button
        android:id=&quot;@+id/save_btn&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:onClick=&quot;click2SaveXML&quot;
        android:text=&quot;@string/save_xml&quot; /&gt;

    &lt;Button
        android:id=&quot;@+id/parse_btn&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:onClick=&quot;click2ParseXML&quot;
        android:text=&quot;@string/parse_xml&quot; /&gt;

    &lt;TextView
        android:id=&quot;@+id/display_tv&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot; /&gt;

&lt;/LinearLayout&gt;
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/13/Android应用开发之使用StringBuilder存储xml文件/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zhuyanlin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YanLin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/13/Android应用开发之使用StringBuilder存储xml文件/" itemprop="url">Android应用开发之使用StringBuilder存储xml文件</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-13T15:16:16+08:00">
                2017-10-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android应用开发/" itemprop="url" rel="index">
                    <span itemprop="name">Android应用开发</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="MainActivity-java"><a href="#MainActivity-java" class="headerlink" title="MainActivity.java"></a>MainActivity.java</h1><pre><code>package com.m520it.SaveXML;

import com.m520it.temp1.R;

import android.app.Activity;
import android.os.Bundle;
import android.view.View;


public class MainActivity extends Activity {

    String mPassport = &quot;zhangsan&quot;;
    String mPassword = &quot;123456&quot;;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);

    }

    public void click2Save(View v) {

        try {
            XMLUtil.saveXMLByStringBuilder(this,mPassport,mPassword);
        } catch (Exception e) {
            e.printStackTrace();
        }

    }

}
</code></pre><h1 id="XMLUtil-java"><a href="#XMLUtil-java" class="headerlink" title="XMLUtil.java"></a>XMLUtil.java</h1><pre><code>package com.m520it.SaveXML;

import java.io.BufferedWriter;
import java.io.File;
import java.io.FileWriter;

public class XMLUtil {

    //一定有异常用throw，可能存在异常用throws
    public static void saveXMLByStringBuilder(MainActivity m,String passport, String password) throws Exception {

        //1、建立一个字符串，相比于String，StringBuilder是可变的
        StringBuilder stringBuilder = new StringBuilder();
        stringBuilder.append(&quot;&lt;map&gt;&quot;);
        stringBuilder.append(&quot;&lt;string name=\&quot;usename\&quot;&gt;&quot;+passport+&quot;&lt;/string&gt;&quot;);
        stringBuilder.append(&quot;&lt;string name=\&quot;psk\&quot;&gt;&quot;+password+&quot;&lt;/string&gt;&quot;);
        stringBuilder.append(&quot;&lt;/map&gt;&quot;);
        String result = stringBuilder.toString();

        //2、创建文件的句柄，getFileDir()是在Content类下的，而MainActivity是继承自Content
        File f = new File(m.getFilesDir(),&quot;qqinfo.xml&quot;);

        //3、使用字符流，并且要进行可能存在异常的检查，我们可以将方法的异常抛出
        BufferedWriter bw = new BufferedWriter(new FileWriter(f));

        //4、写入刚刚建立的字符串
        bw.write(result);

        //5、初次之外，还需进行刷新，当然关闭文件也是可以的，里面已经进行了刷新
        //bw.flush();
        bw.close();
    }
}
</code></pre><h1 id="activity-main-xml"><a href="#activity-main-xml" class="headerlink" title="activity_main.xml"></a>activity_main.xml</h1><pre><code>&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot; &gt;

    &lt;Button
        android:id=&quot;@+id/save_btn&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:onClick=&quot;click2Save&quot;
        android:text=&quot;点击存储&quot; /&gt;

&lt;/LinearLayout&gt;
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/12/C语言白学系列_1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zhuyanlin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YanLin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/12/C语言白学系列_1/" itemprop="url">C语言白学系列_1</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-12T21:35:59+08:00">
                2017-10-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/C语言白学/" itemprop="url" rel="index">
                    <span itemprop="name">C语言白学</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="在u-boot中的一行代码，让我感到C语言白学了"><a href="#在u-boot中的一行代码，让我感到C语言白学了" class="headerlink" title="在u-boot中的一行代码，让我感到C语言白学了"></a>在u-boot中的一行代码，让我感到C语言白学了</h1><pre><code>/*这里定义了一个新的数据类型init_fnc_t，
 *这个数据类型是参数为空，返回值为int的函数。
 */
typedef int (init_fnc_t) (void);
/*init_sequence是一个指针数组，指向的是init_fnc_t类型的函数*/
init_fnc_t *init_sequence[] = {
    cpu_init, /* basic cpu dependent setup */
    board_init, /* basic board dependent setup */
    interrupt_init, /* set up exceptions */
    env_init, /* initialize environment */
    init_baudrate, /* initialze baudrate settings */
    serial_init, /* serial communications setup */
    console_init_f, /* stage 1 init of console */
    display_banner, /* say that we are here */
    dram_init, /* configure available RAM banks */
    display_dram_config,
#if defined(CONFIG_VCMA9) || defined (CONFIG_CMC_PU2)
    checkboard,
#endif
    NULL,
};

/*init_fnc_ptr为指向函数指针的指针*/
init_fnc_t **init_fnc_ptr;
/*init_fnc_ptr初始化指向init_sequence指针数组，下面的循环遇到NULL结束*/
for (init_fnc_ptr = init_sequence; *init_fnc_ptr; ++init_fnc_ptr) {
    if ((*init_fnc_ptr)() != 0) {/*(*init_fnc_ptr)()为C中调用指针指向的函数*/
        hang ();
    }
}
</code></pre><h1 id="一位大神的例子"><a href="#一位大神的例子" class="headerlink" title="一位大神的例子"></a>一位大神的例子</h1><h2 id="他写了两个函数-：-typedef-int-test-fnc-t-void-和一个typedef-int-test-fnc-t-void"><a href="#他写了两个函数-：-typedef-int-test-fnc-t-void-和一个typedef-int-test-fnc-t-void" class="headerlink" title="他写了两个函数 ： typedef int (test_fnc_t) (void);和一个typedef int (*test_fnc_t) (void);"></a>他写了两个函数 ： typedef int (test_fnc_t) (void);和一个typedef int (*test_fnc_t) (void);</h2><pre><code>#include&lt;stdio.h&gt;

int test0 (void);
int test1 (void);

typedef int (*test_fnc_t) (void);

test_fnc_t test_sequence[] = {
    test0,        
    test1,        
    NULL,
};


//int _tmain(int argc, _TCHAR* argv[])

int main()
{
    test_fnc_t *test_fnc_ptr;

    for (test_fnc_ptr = test_sequence; *test_fnc_ptr; ++test_fnc_ptr) {
        if ((*test_fnc_ptr)() != 0) {
            printf(&quot;error here!&quot;);
        }
    }

    return 0;
}

int test0 (void)
{
    printf(&quot;test0/n&quot;);
    return 0;
}

int test1 (void)
{
    printf(&quot;test1/n&quot;);
    return 0;
}
</code></pre><h1 id="来源是http-blog-csdn-net-delphi308-article-details-6459596"><a href="#来源是http-blog-csdn-net-delphi308-article-details-6459596" class="headerlink" title="来源是http://blog.csdn.net/delphi308/article/details/6459596"></a>来源是<a href="http://blog.csdn.net/delphi308/article/details/6459596" target="_blank" rel="external">http://blog.csdn.net/delphi308/article/details/6459596</a></h1>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/12/Android应用开发之利用字节流向SDCard写入数据/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zhuyanlin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YanLin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/12/Android应用开发之利用字节流向SDCard写入数据/" itemprop="url">Android应用开发之利用字节流向SDCard写入数据</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-12T10:26:13+08:00">
                2017-10-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android应用开发/" itemprop="url" rel="index">
                    <span itemprop="name">Android应用开发</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="MainActivity-java"><a href="#MainActivity-java" class="headerlink" title="MainActivity.java"></a>MainActivity.java</h1><pre><code>package com.m520it.temp;

import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;
import java.io.IOException;

import android.app.Activity;
import android.os.Bundle;
import android.os.Environment;
import android.util.Log;
import android.view.View;
import android.view.View.OnClickListener;
import android.widget.Button;


public class MainActivity extends Activity {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);


        Button downloadBtn = (Button) findViewById(R.id.download_btn);

        downloadBtn.setOnClickListener(new OnClickListener() {

            @Override
            public void onClick(View v) {

                Log.v(&quot;123456789&quot;, &quot;clicked&quot;);

                try {

                    String parentFile = Environment.getExternalStorageState();

                    //1、判断SD卡是否已经挂载
                    if(parentFile.equals(Environment.MEDIA_MOUNTED)) {

                        //2、设置文件的句柄
                        File f = new File(Environment.getExternalStorageDirectory(), &quot;demo.avi&quot;);

                        //3、使用字节流向所在目录中输出
                        FileOutputStream fos = new FileOutputStream(f);

                        //4、因为是使用的字节流，所以应该创建一个字节流数组，并且以某个单位长度（在这里是1M）进行输出
                        byte[] data = new byte[1024*1024];
                        for(int i = 0;i&lt;10;i++) {
                            fos.write(data);
                        }

                        //5、关闭字节流
                        fos.close();

                    }
                } catch (FileNotFoundException e) {
                    e.printStackTrace();
                } catch (IOException e) {
                    e.printStackTrace();
                }

            }

        });
    }

}
</code></pre><h1 id="acitvity-main-xml"><a href="#acitvity-main-xml" class="headerlink" title="acitvity_main.xml"></a>acitvity_main.xml</h1><pre><code>&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot;
    android:orientation=&quot;vertical&quot; &gt;

    &lt;Button
        android:id=&quot;@+id/download_btn&quot;
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:text=&quot;@string/download2SDCard&quot; /&gt;

&lt;/LinearLayout&gt;
</code></pre><h1 id="AndroidManifest-xml-在这里主要是设置允许写入SDCard的权限-、"><a href="#AndroidManifest-xml-在这里主要是设置允许写入SDCard的权限-、" class="headerlink" title="AndroidManifest.xml(在这里主要是设置允许写入SDCard的权限)、"></a>AndroidManifest.xml(在这里主要是设置允许写入SDCard的权限)、</h1><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;manifest xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    package=&quot;com.m520it.temp&quot;
    android:versionCode=&quot;1&quot;
    android:versionName=&quot;1.0&quot; &gt;

    &lt;uses-sdk
        android:minSdkVersion=&quot;14&quot;
        android:targetSdkVersion=&quot;19&quot; /&gt;

    &lt;application
        android:allowBackup=&quot;true&quot;
        android:icon=&quot;@drawable/ic_launcher&quot;
        android:label=&quot;@string/app_name&quot;
        android:theme=&quot;@style/AppTheme&quot; &gt;
        &lt;activity
            android:name=&quot;.MainActivity&quot;
            android:label=&quot;@string/app_name&quot; &gt;
            &lt;intent-filter&gt;
                &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;

                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;
            &lt;/intent-filter&gt;
        &lt;/activity&gt;
    &lt;/application&gt;
    &lt;uses-permission 
        android:name=&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot;/&gt;
&lt;/manifest&gt;
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/11/S3C2440嵌入式之mkconfig文件分析/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zhuyanlin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YanLin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/11/S3C2440嵌入式之mkconfig文件分析/" itemprop="url">S3C2440嵌入式之mkconfig文件分析</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-11T20:25:08+08:00">
                2017-10-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/嵌入式linux开发/" itemprop="url" rel="index">
                    <span itemprop="name">嵌入式linux开发</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="mkconfig文件内容（关键语句旁边用“-”注释）"><a href="#mkconfig文件内容（关键语句旁边用“-”注释）" class="headerlink" title="mkconfig文件内容（关键语句旁边用“##”注释）"></a>mkconfig文件内容（关键语句旁边用“##”注释）</h1><pre><code>#!/bin/sh -e

# Script to create header files and links to configure
# U-Boot for a specific board.
#
# Parameters:  Target  Architecture  CPU  Board [VENDOR] [SOC]
#
# (C) 2002-2006 DENX Software Engineering, Wolfgang Denk &lt;wd@denx.de&gt;
#

##MakeFile中的配置指令，即执行make 100ask24x0_config
##mkconfig 100ask24x0 arm arm920t 100ask24x0 NULL s3c24x0
##              $1      $2    $3        $4     $5    $6

APPEND=no    # Default: Create new config file
BOARD_NAME=&quot;&quot;    # Name to print in make output

while [ $# -gt 0 ] ; do
    case &quot;$1&quot; in
    --) shift ; break ;;
    -a) shift ; APPEND=yes ;;
    -n) shift ; BOARD_NAME=&quot;${1%%_config}&quot; ; shift ;;
    *)  break ;;
    esac
done
##上面16~22行是检查指令中是否有--,-a,-n,*的，显然是没有的

[ &quot;${BOARD_NAME}&quot; ] || BOARD_NAME=&quot;$1&quot;
##这个和C语言的条件编译好像，实际上这行代码与下一行意思一样
##BOARD_NAME = 100ask24x0

[ $# -lt 4 ] &amp;&amp; exit 1
[ $# -gt 6 ] &amp;&amp; exit 1
##参数个数小于4个或者大于6个则退出

echo &quot;Configuring for ${BOARD_NAME} board...&quot;
##打印后面的字符串

#
# Create link to architecture specific headers
#
if [ &quot;$SRCTREE&quot; != &quot;$OBJTREE&quot; ] ; then
##显然条件不成立，执行else语句
    mkdir -p ${OBJTREE}/include
    mkdir -p ${OBJTREE}/include2
    cd ${OBJTREE}/include2
    rm -f asm
    ln -s ${SRCTREE}/include/asm-$2 asm
    LNPREFIX=&quot;../../include2/asm/&quot;
    cd ../include
    rm -rf asm-$2
    rm -f asm
    mkdir asm-$2
    ln -s asm-$2 asm
else
    cd ./include
    ##此时已经进入到了include文件夹中
    rm -f asm
    ln -s asm-$2 asm
fi

rm -f asm-$2/arch

if [ -z &quot;$6&quot; -o &quot;$6&quot; = &quot;NULL&quot; ] ; then
##判断第6个参数是为空或是等于&quot;NULL&quot;
    ln -s ${LNPREFIX}arch-$3 asm-$2/arch
else
    ln -s ${LNPREFIX}arch-$6 asm-$2/arch
fi

if [ &quot;$2&quot; = &quot;arm&quot; ] ; then
    rm -f asm-$2/proc
    ln -s ${LNPREFIX}proc-armv asm-$2/proc
fi

#
# Create include file for Make
#
echo &quot;ARCH   = $2&quot; &gt;  config.mk
echo &quot;CPU    = $3&quot; &gt;&gt; config.mk
echo &quot;BOARD  = $4&quot; &gt;&gt; config.mk
##一个&quot;&lt;&quot;表示创建文件，两个&quot;&lt;&lt;&quot;表示追加内容
##上面78~81行相当于config.mk内容为
##ARCH = arm
##CPU = arm920t
## BOARD = 100ask24x0

[ &quot;$5&quot; ] &amp;&amp; [ &quot;$5&quot; != &quot;NULL&quot; ] &amp;&amp; echo &quot;VENDOR = $5&quot; &gt;&gt; config.mk

[ &quot;$6&quot; ] &amp;&amp; [ &quot;$6&quot; != &quot;NULL&quot; ] &amp;&amp; echo &quot;SOC    = $6&quot; &gt;&gt; config.mk
##继续在config.mk中追加SOC = s3c24x0

#
# Create board specific header file
#
##创建一个单板相关的头文件
if [ &quot;$APPEND&quot; = &quot;yes&quot; ]    # Append to existing config file
then
    echo &gt;&gt; config.h
else
    &gt; config.h        # Create new config file
fi
echo &quot;/* Automatically generated - do not edit */&quot; &gt;&gt;config.h
echo &quot;#include &lt;configs/$1.h&gt;&quot; &gt;&gt;config.h

exit 0
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/11/Android应用开发之QQ登录界面/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="zhuyanlin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="YanLin">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/10/11/Android应用开发之QQ登录界面/" itemprop="url">Android应用开发之QQ登录界面</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-11T18:18:13+08:00">
                2017-10-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Android应用开发/" itemprop="url" rel="index">
                    <span itemprop="name">Android应用开发</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="MainActivity-java"><a href="#MainActivity-java" class="headerlink" title="MainActivity.java"></a>MainActivity.java</h1><pre><code>package com.m520it.temp;

import java.io.BufferedReader;
import java.io.BufferedWriter;
import java.io.File;
import java.io.FileReader;
import java.io.FileWriter;
import java.io.IOException;

import android.annotation.SuppressLint;
import android.app.Activity;
import android.os.Bundle;
import android.text.TextUtils;
import android.view.View;
import android.widget.EditText;
import android.widget.Toast;


@SuppressLint(&quot;SdCardPath&quot;) public class MainActivity extends Activity {

    //1、定义全局变量，前面是m开头
    private EditText mPassportEt;
    private EditText mPasswordEt;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);


        //2、获取账号和密码这两个控件的id
        mPassportEt = (EditText) findViewById(R.id.passport_et);
        mPasswordEt = (EditText) findViewById(R.id.password_et);

        //6、读取保存的账号和密码，再下次打开app的时候回显，相当于记住账号和密码的功能
        //本来是犯了一个很严重的错误，居然把读取数据放到了按钮下面，真是蠢啊
        readData();
    }

    public void loginClick(View v) {

        //3、获取EditText中的文本
        String passport = mPassportEt.getText().toString();
        String password = mPasswordEt.getText().toString();

        //4、判断账号和密码是不是为空，调用TextUtils工具类进行判断
        if(TextUtils.isEmpty(passport)&amp;&amp;TextUtils.isEmpty(password)) {
            Toast.makeText(getApplicationContext(), &quot;请填写账号和密码&quot;, 0).show();
            //视频教程中说加上return，但是我试了一下，不加return也没有什么影响
            //return;
        }

        else if(TextUtils.isEmpty(passport)) {
            Toast.makeText(getApplicationContext(), &quot;请填写账号&quot;, 0).show();
        }

        else if(TextUtils.isEmpty(password)) {
            Toast.makeText(getApplicationContext(), &quot;请填写密码&quot;, 0).show();
        }

        //5、保存信息，主要是账号和密码
        savaData(passport,password);

    }

    private void savaData(String passport, String password) {

        try {
            //5-1、声明一个文件类，并设置其句柄
            //File file = new File(&quot;/data/data/com.m520it.temp/cache/qqinfo.txt&quot;);
            File file = new File(getCacheDir(), &quot;qqinfo.txt&quot;);

            //5-2、声明一个字符流缓冲区，实际上FileWriter类型变量才是写入数据的主力而不是File类型变量
            BufferedWriter writer = new BufferedWriter(new FileWriter(file));

            //5-3、写入字符串，账号和密码以&quot;#&quot;分隔
            writer.write(passport+&quot;#&quot;+password);

            //5-4、关闭文件
            writer.close();
        } catch (IOException e) {
            e.printStackTrace();
        }

    }

    private void readData() {


        try {
            //6-1、声明一个文件类，并设置句柄
            //File file = new File(&quot;/data/data/com.m520it.temp/cache/qqinfo.txt&quot;);
            File file = new File(getCacheDir(), &quot;qqinfo.txt&quot;);

            //6-2、检查文件是否存在，为了保险起见，同时检查文件中是否有内容
            if(file.exists()) {

                //6-3、字符流缓冲区，构造器中为FileReader类
                BufferedReader reader = new BufferedReader(new FileReader(file));

                //6-4、读取文件中的单行数据
                String line = reader.readLine();

                //6-5、关闭文件
                reader.close();

                //6-6、判断文件中是否用&quot;#&quot;将账号和密码分隔开来
                if(line.contains(&quot;#&quot;)) {

                    //6-7、以&quot;#&quot;为参考分隔成两个字符串
                    String[] datas = line.split(&quot;#&quot;);

                    //6-8、使EditText回显
                    mPassportEt.setText(datas[0]);
                    mPasswordEt.setText(datas[1]);

                }
            }

            //**注意这里原来是FileNotFoundException，但是因为已经检查文件是否存在了，就改为Exception
        } catch (Exception e) {
            e.printStackTrace();
        }

    }

}
</code></pre><h1 id="activity-main-xml"><a href="#activity-main-xml" class="headerlink" title="activity_main.xml"></a>activity_main.xml</h1><pre><code>&lt;LinearLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;
    xmlns:tools=&quot;http://schemas.android.com/tools&quot;
    android:layout_width=&quot;match_parent&quot;
    android:layout_height=&quot;match_parent&quot; 
    android:orientation=&quot;vertical&quot;&gt;

    &lt;ImageView 
        android:layout_width=&quot;wrap_content&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:src=&quot;@drawable/qq&quot;
        android:layout_gravity=&quot;center_horizontal&quot;
        android:layout_marginTop=&quot;75dp&quot;
        android:contentDescription=&quot;@string/QQlogin_imv_dec&quot;/&gt;

    &lt;LinearLayout 
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:orientation=&quot;horizontal&quot;
        android:layout_marginTop=&quot;60dp&quot;
        android:paddingLeft=&quot;35dp&quot;
        android:paddingRight=&quot;35dp&quot;&gt;

        &lt;TextView 
            android:layout_width=&quot;wrap_content&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:text=&quot;@string/passport_tvname&quot;
            android:textSize=&quot;20sp&quot;/&gt;

        &lt;EditText 
            android:id=&quot;@+id/passport_et&quot;
            android:layout_width=&quot;match_parent&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_marginLeft=&quot;10dp&quot;
            android:hint=&quot;@string/passport_hint&quot;
            android:textSize=&quot;20sp&quot;/&gt;

    &lt;/LinearLayout&gt;

    &lt;LinearLayout 
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:orientation=&quot;horizontal&quot;
        android:layout_marginTop=&quot;20dp&quot;
        android:paddingLeft=&quot;35dp&quot;
        android:paddingRight=&quot;35dp&quot;&gt;

        &lt;TextView 
            android:layout_width=&quot;wrap_content&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:text=&quot;@string/password_tvname&quot;
            android:textSize=&quot;20sp&quot;/&gt;

        &lt;EditText 
            android:id=&quot;@+id/password_et&quot;
            android:layout_width=&quot;match_parent&quot;
            android:layout_height=&quot;wrap_content&quot;
            android:layout_marginLeft=&quot;10dp&quot;
            android:hint=&quot;@string/password_hin&quot;
            android:textSize=&quot;20sp&quot;
            android:inputType=&quot;textPassword&quot;/&gt;

    &lt;/LinearLayout&gt;

    &lt;LinearLayout 
        android:layout_width=&quot;match_parent&quot;
        android:layout_height=&quot;wrap_content&quot;
        android:orientation=&quot;horizontal&quot;
        android:layout_marginTop=&quot;70dp&quot;
        android:paddingLeft=&quot;10dp&quot;
        android:paddingRight=&quot;10dp&quot;&gt;

        &lt;Button 
            android:layout_width=&quot;match_parent&quot;
            android:layout_height=&quot;50dp&quot;
            android:layout_weight=&quot;1&quot;
            android:text=&quot;@string/sign_btn_info&quot;
            style=&quot;@android:attr/buttonStyle&quot;/&gt;

        &lt;Button 
            android:layout_width=&quot;match_parent&quot;
            android:layout_marginLeft=&quot;10dp&quot;
            android:layout_height=&quot;50dp&quot;
            android:layout_weight=&quot;1&quot;
            android:onClick=&quot;loginClick&quot;
            android:text=&quot;@string/login_btn_info&quot;
            style=&quot;@android:attr/buttonStyle&quot;/&gt;

    &lt;/LinearLayout&gt;

&lt;/LinearLayout&gt;
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.png"
               alt="zhuyanlin" />
          <p class="site-author-name" itemprop="name">zhuyanlin</p>
           
              <p class="site-description motion-element" itemprop="description">zhuyanlin的个人博客</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">14</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">3</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">13</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">zhuyanlin</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.2"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.2"></script>



  
  

  
    <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.2"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.2"></script>

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.2"></script>



  


  




	





  





  






  




  
  
  
  <link rel="stylesheet" href="/lib/algolia-instant-search/instantsearch.min.css">

  
  
  <script src="/lib/algolia-instant-search/instantsearch.min.js"></script>
  

  <script src="/js/src/algolia-search.js?v=5.1.2"></script>



  

  

  

  

  

  

</body>
</html>
